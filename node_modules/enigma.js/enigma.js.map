{"version":3,"file":"enigma.js","sources":["node_modules/node-event-emitter/index.js","src/event-emitter.js","src/session.js","src/cache.js","src/schema.js","src/rpc-resolver.js","src/rpc.js","src/suspend-resume.js","src/interceptors/request/delta.js","src/interceptors/response/api.js","node_modules/extend/index.js","src/json-patch.js","src/interceptors/response/delta.js","src/interceptors/response/error.js","src/interceptors/response/out-param.js","src/interceptors/response/result.js","src/intercept.js","src/api-cache.js","src/qix.js"],"sourcesContent":["/**\n * Utility functions\n */\n\nvar util = {};\n\nutil.isObject = function isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nutil.isNumber = function isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nutil.isUndefined = function isUndefined(arg) {\n  return arg === void 0;\n}\n\nutil.isFunction = function isFunction(arg){\n  return typeof arg === 'function';\n}\n\n\n/**\n * EventEmitter class\n */\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\nEventEmitter.init = function() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!util.isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error' && !this._events.error) {\n    er = arguments[1];\n    if (er instanceof Error) {\n      throw er; // Unhandled 'error' event\n    } else {\n      throw Error('Uncaught, unspecified \"error\" event.');\n    }\n    return false;\n  }\n\n  handler = this._events[type];\n\n  if (util.isUndefined(handler))\n    return false;\n\n  if (util.isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        len = arguments.length;\n        args = new Array(len - 1);\n        for (i = 1; i < len; i++)\n          args[i - 1] = arguments[i];\n        handler.apply(this, args);\n    }\n  } else if (util.isObject(handler)) {\n    len = arguments.length;\n    args = new Array(len - 1);\n    for (i = 1; i < len; i++)\n      args[i - 1] = arguments[i];\n\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!util.isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              util.isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (util.isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (util.isObject(this._events[type]) && !this._events[type].warned) {\n    var m;\n    if (!util.isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n\n      if (util.isFunction(console.error)) {\n        console.error('(node) warning: possible EventEmitter memory ' +\n                      'leak detected. %d listeners added. ' +\n                      'Use emitter.setMaxListeners() to increase limit.',\n                      this._events[type].length);\n      }\n      if (util.isFunction(console.trace))\n        console.trace();\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!util.isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!util.isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (util.isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (util.isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (util.isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (Array.isArray(listeners)) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (util.isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  var ret;\n  if (!emitter._events || !emitter._events[type])\n    ret = 0;\n  else if (util.isFunction(emitter._events[type]))\n    ret = 1;\n  else\n    ret = emitter._events[type].length;\n  return ret;\n};\n","import EventEmitter from 'node-event-emitter';\n\n/**\n* @module EventEmitter\n* @private\n*/\nexport default {\n\n  /**\n  * Function used to add event handling to objects passed in.\n  * @param {Object} obj Object instance that will get event handling.\n  */\n  mixin: (obj) => {\n    Object.keys(EventEmitter.prototype).forEach((key) => {\n      obj[key] = EventEmitter.prototype[key];\n    });\n    EventEmitter.init(obj);\n  },\n};\n","import EventEmitter from './event-emitter';\n\nconst RPC_CLOSE_NORMAL = 1000;\nconst RPC_CLOSE_MANUAL_SUSPEND = 4000;\n\nlet cacheId = 0;\n\n/**\n * The QIX Engine session object\n */\nclass Session {\n  /**\n   * Handle opened state. This event is triggered whenever the websocket is connected and ready for\n   * communication.\n   * @event Session#opened\n   * @type {Object}\n   */\n\n  /**\n   * Handle closed state. This event is triggered when the underlying websocket is closed and\n   * config.suspendOnClose is false.\n   * @event Session#closed\n   * @type {Object}\n   */\n\n  /**\n   * Handle suspended state. This event is triggered in two cases (listed below). It is useful\n   * in scenarios where you for example want to block interaction in your application until you\n   * are resumed again. If config.suspendOnClose is true and there was a network disconnect\n   * (socked closed) or if you ran session.suspend().\n   * @event Session#suspended\n   * @type {Object}\n   * @param {Object} evt Event object.\n   * @param {String} evt.initiator String indication what triggered the suspended state. Possible\n   * values network, manual.\n   */\n\n  /**\n   * Handle resumed state. This event is triggered when the session was properly resumed. It is\n   * useful in scenarios where you for example can close blocking modal dialogs and allow the user\n   * to interact with your application again.\n   * @event Session#resumed\n   * @type {Object}\n   */\n\n  /**\n   * Handle all JSON-RPC notification event, 'notification:*. Or handle a specific JSON-RPC\n   * notification event, 'notification:OnConnected'. These events depend on the product you use QIX\n   * Engine from.\n   * @event Session#notification\n   * @type {Object}\n   */\n\n  /**\n  * Handle websocket messages. Generally used in debugging purposes. traffic:* will handle all\n  * websocket messages, traffic:sent will handle outgoing messages and traffic:received will handle\n  * incoming messages.\n  * @event Session#traffic\n  * @type {Object}\n  */\n\n  constructor(options) {\n    const session = this;\n    Object.assign(session, options);\n    this.Promise = this.config.Promise;\n    this.definition = this.config.definition;\n    EventEmitter.mixin(session);\n    cacheId += 1;\n    session.id = cacheId;\n    session.rpc.on('socket-error', session.onRpcError.bind(session));\n    session.rpc.on('closed', session.onRpcClosed.bind(session));\n    session.rpc.on('message', session.onRpcMessage.bind(session));\n    session.rpc.on('notification', session.onRpcNotification.bind(session));\n    session.rpc.on('traffic', session.onRpcTraffic.bind(session));\n    session.on('closed', () => session.onSessionClosed());\n  }\n\n  /**\n  * Event handler for re-triggering error events from RPC.\n  * @private\n  * @emits socket-error\n  * @param {Error} err Webocket error event.\n  */\n  onRpcError(err) {\n    if (this.suspendResume.isSuspended) {\n      return;\n    }\n    this.emit('socket-error', err);\n  }\n\n  /**\n  * Event handler for the RPC close event.\n  * @private\n  * @emits Session#suspended\n  * @emits Session#closed\n  * @param {Event} evt WebSocket close event.\n  */\n  onRpcClosed(evt) {\n    if (this.suspendResume.isSuspended) {\n      return;\n    }\n    if (evt.code === RPC_CLOSE_NORMAL || evt.code === RPC_CLOSE_MANUAL_SUSPEND) {\n      return;\n    }\n    if (this.config.suspendOnClose) {\n      this.suspendResume.suspend().then(() => this.emit('suspended', { initiator: 'network' }));\n    } else {\n      this.emit('closed', evt);\n    }\n  }\n\n  /**\n  * Event handler for the RPC message event.\n  * @private\n  * @param {Object} response JSONRPC response.\n  */\n  onRpcMessage(response) {\n    if (this.suspendResume.isSuspended) {\n      return;\n    }\n    if (response.change) {\n      response.change.forEach(handle => this.emitHandleChanged(handle));\n    }\n    if (response.close) {\n      response.close.forEach(handle => this.emitHandleClosed(handle));\n    }\n  }\n\n  /**\n  * Event handler for the RPC notification event.\n  * @private\n  * @emits Session#notification\n  * @param {Object} response The JSONRPC notification.\n  */\n  onRpcNotification(response) {\n    this.emit('notification:*', response.method, response.params);\n    this.emit(`notification:${response.method}`, response.params);\n  }\n\n  /**\n  * Event handler for the RPC traffic event.\n  * @private\n  * @emits Session#traffic\n  * @param {String} dir The traffic direction, sent or received.\n  * @param {Object} data JSONRPC request/response/WebSocket message.\n  * @param {Number} handle The associated handle.\n  */\n  onRpcTraffic(dir, data, handle) {\n    this.emit('traffic:*', dir, data);\n    this.emit(`traffic:${dir}`, data);\n    const api = this.apis.getApi(handle);\n    if (api) {\n      api.emit('traffic:*', dir, data);\n      api.emit(`traffic:${dir}`, data);\n    }\n  }\n\n  /**\n  * Event handler for cleaning up API instances when a session has been closed.\n  * @private\n  * @emits API#closed\n  */\n  onSessionClosed() {\n    this.apis.getApis().forEach((entry) => {\n      entry.api.emit('closed');\n      entry.api.removeAllListeners();\n    });\n    this.apis.clear();\n  }\n\n  /**\n   * Function used to get an API for a backend object.\n   * @private\n   * @param {Object} args Arguments used to create object API.\n   * @param {Number} args.handle Handle of the backend object.\n   * @param {String} args.id ID of the backend object.\n   * @param {String} args.type QIX type of the backend object. Can for example\n   *                           be \"Doc\" or \"GenericVariable\".\n   * @param {String} args.genericType Custom type of the backend object, if defined in qInfo.\n   * @returns {*} Returns the generated and possibly augmented API.\n   */\n  getObjectApi(args) {\n    const {\n      handle, id, type, genericType,\n    } = args;\n    let api = this.apis.getApi(handle);\n    if (api) {\n      return api;\n    }\n    const factory = this.definition.generate(type);\n    api = factory(this, handle, id, genericType);\n    this.apis.add(handle, api);\n    return api;\n  }\n\n  /**\n  * Establishes the websocket against the configured URL and returns the Global instance.\n  * @emits Session#opened\n  * @returns {Promise<Object>} Eventually resolved if the connection was successful.\n  */\n  open() {\n    if (!this.globalPromise) {\n      const args = {\n        handle: -1,\n        id: 'Global',\n        type: 'Global',\n        genericType: 'Global',\n      };\n      this.globalPromise = this.rpc.open()\n        .then(() => this.getObjectApi(args))\n        .then((global) => {\n          this.emit('opened');\n          return global;\n        });\n    }\n    return this.globalPromise;\n  }\n\n  /**\n  * Function used to send data on the RPC socket.\n  * @param {Object} request The request to be sent. (data and some meta info)\n  * @returns {Object} Returns a promise instance.\n  */\n  send(request) {\n    if (this.suspendResume.isSuspended) {\n      return this.Promise.reject(new Error('Session suspended'));\n    }\n    request.id = this.rpc.createRequestId();\n    const promise = this.intercept.executeRequests(this, this.Promise.resolve(request))\n      .then((augmentedRequest) => {\n        const data = Object.assign({}, this.config.protocol, augmentedRequest);\n        // the outKey value is used by multiple-out interceptor, at some point\n        // we need to refactor that implementation and figure out how to transport\n        // this value without hijacking the JSONRPC request object:\n        delete data.outKey;\n        const response = this.rpc.send(data);\n        augmentedRequest.retry = () => this.send(request);\n        return this.intercept.executeResponses(this, response, augmentedRequest);\n      });\n    Session.addToPromiseChain(promise, 'requestId', request.id);\n    return promise;\n  }\n\n  /**\n  * Suspends the enigma.js session by closing the websocket and rejecting all method calls\n  * until is has been resumed again.\n  * @emits Session#suspended\n  * @returns {Promise<Object>} Eventually resolved when the websocket has been closed.\n  */\n  suspend() {\n    return this.suspendResume.suspend()\n      .then(() => this.emit('suspended', { initiator: 'manual' }));\n  }\n\n  /**\n  * Resumes a previously suspended enigma.js session by re-creating the websocket and,\n  * if possible, re-open the document as well as refreshing the internal cashes. If successful,\n  * changed events will be triggered on all generated APIs, and on the ones it was unable to\n  * restore, the closed event will be triggered.\n  * @emits Session#resumed\n  * @param {Boolean} onlyIfAttached If true, resume only if the session was re-attached properly.\n  * @returns {Promise<Object>} Eventually resolved when the websocket (and potentially the\n  * previously opened document, and generated APIs) has been restored, rejected when it fails any\n  * of those steps, or when onlyIfAttached is true and a new session was created.\n  */\n  resume(onlyIfAttached) {\n    return this.suspendResume.resume(onlyIfAttached).then((value) => {\n      this.emit('resumed');\n      return value;\n    });\n  }\n\n  /**\n  * Closes the websocket and cleans up internal caches, also triggers the closed event\n  * on all generated APIs. Note that you have to manually invoke this when you want to\n  * close a session and config.suspendOnClose is true.\n  * @emits Session#closed\n  * @returns {Promise<Object>} Eventually resolved when the websocket has been closed.\n  */\n  close() {\n    this.globalPromise = undefined;\n    return this.rpc.close().then(evt => this.emit('closed', evt));\n  }\n\n  /**\n  * Given a handle, this function will emit the 'changed' event on the\n  * corresponding API instance.\n  * @private\n  * @param {Number} handle The handle of the API instance.\n  * @emits API#changed\n  */\n  emitHandleChanged(handle) {\n    const api = this.apis.getApi(handle);\n    if (api) {\n      api.emit('changed');\n    }\n  }\n\n  /**\n  * Given a handle, this function will emit the 'closed' event on the\n  * corresponding API instance.\n  * @private\n  * @param {Number} handle The handle of the API instance.\n  * @emits API#closed\n  */\n  emitHandleClosed(handle) {\n    const api = this.apis.getApi(handle);\n    if (api) {\n      api.emit('closed');\n      api.removeAllListeners();\n    }\n  }\n\n  /**\n  * Function used to add info on the promise chain.\n  * @private\n  * @param {Promise<Object>} promise The promise to add info on.\n  * @param {String} name The property to add info on.\n  * @param {Any} value The info to add.\n  */\n  static addToPromiseChain(promise, name, value) {\n    promise[name] = value;\n    const { then } = promise;\n    promise.then = function patchedThen(...params) {\n      const chain = then.apply(this, params);\n      Session.addToPromiseChain(chain, name, value);\n      return chain;\n    };\n  }\n}\n\nexport default Session;\n","/**\n* Key-value cache\n* @private\n*/\nclass KeyValueCache {\n  constructor() {\n    this.entries = {};\n  }\n\n  /**\n  * Adds an entry.\n  * @private\n  * @function KeyValueCache#add\n  * @param {String} key The key representing an entry.\n  * @param {*} entry The entry to be added.\n  */\n  add(key, entry) {\n    key += '';\n    if (typeof this.entries[key] !== 'undefined') {\n      throw new Error(`Entry already defined with key ${key}`);\n    }\n    this.entries[key] = entry;\n  }\n\n  /**\n  * Sets an entry.\n  * @private\n  * @function KeyValueCache#set\n  * @param {String} key The key representing an entry.\n  * @param {*} entry The entry.\n  */\n  set(key, entry) {\n    key += '';\n    this.entries[key] = entry;\n  }\n\n  /**\n  * Removes an entry.\n  * @private\n  * @function KeyValueCache#remove\n  * @param {String} key The key representing an entry.\n  */\n  remove(key) {\n    delete this.entries[key];\n  }\n\n  /**\n  * Gets an entry.\n  * @private\n  * @function KeyValueCache#get\n  * @param {String} key The key representing an entry.\n  * @returns {*} The entry for the key.\n  */\n  get(key) {\n    return this.entries[key];\n  }\n\n  /**\n  * Gets a list of all entries.\n  * @private\n  * @function KeyValueCache#getAll\n  * @returns {Array} The list of entries including its `key` and `value` properties.\n  */\n  getAll() {\n    return Object.keys(this.entries).map(key => ({\n      key,\n      value: this.entries[key],\n    }));\n  }\n\n  /**\n  * Gets a key for an entry.\n  * @private\n  * @function KeyValueCache#getKey\n  * @param {*} entry The entry to locate the key for.\n  * @returns {String} The key representing an entry.\n  */\n  getKey(entry) {\n    return Object.keys(this.entries).filter(key => this.entries[key] === entry)[0];\n  }\n\n  /**\n  * Clears the cache of all entries.\n  * @private\n  * @function KeyValueCache#clear\n  */\n  clear() {\n    this.entries = {};\n  }\n}\n\nexport default KeyValueCache;\n","import KeyValueCache from './cache';\nimport Events from './event-emitter';\n\nconst { hasOwnProperty } = Object.prototype;\n\n/**\n* Returns the camelCase counterpart of a symbol.\n* @private\n* @param {String} symbol The symbol.\n* @return the camelCase counterpart.\n*/\nfunction toCamelCase(symbol) {\n  return symbol.substring(0, 1).toLowerCase() + symbol.substring(1);\n}\n\n/**\n * A facade function that allows parameters to be passed either by name\n * (through an object), or by position (through an array).\n * @private\n * @param {Function} base The function that is being overriden. Will be\n *                        called with parameters in array-form.\n * @param {Object} defaults Parameter list and it's default values.\n * @param {*} params The parameters.\n */\nfunction namedParamFacade(base, defaults, ...params) {\n  if (params.length === 1 && typeof params[0] === 'object' && !Array.isArray(params[0])) {\n    const valid = Object.keys(params[0]).every(key => hasOwnProperty.call(defaults, key));\n    if (valid) {\n      params = Object.keys(defaults).map(key => params[0][key] || defaults[key]);\n    }\n  }\n  return base.apply(this, params);\n}\n\n/**\n* Qix schema definition.\n* @private\n*/\nclass Schema {\n  /**\n  * Create a new schema instance.\n  * @private\n  * @param {Configuration} config The configuration for QIX.\n  */\n  constructor(config) {\n    this.config = config;\n    this.Promise = config.Promise;\n    this.schema = config.schema;\n    this.mixins = new KeyValueCache();\n    this.types = new KeyValueCache();\n  }\n\n  registerMixin({\n    types, type, extend, override, init,\n  }) {\n    if (!Array.isArray(types)) {\n      types = [types];\n    }\n    // to support a single type\n    if (type) {\n      types.push(type);\n    }\n    const cached = { extend, override, init };\n    types.forEach((typeKey) => {\n      const entryList = this.mixins.get(typeKey);\n      if (entryList) {\n        entryList.push(cached);\n      } else {\n        this.mixins.add(typeKey, [cached]);\n      }\n    });\n  }\n\n  /**\n  * Function used to generate a type definition.\n  * @private\n  * @param {String} type The type.\n  * @returns {{create: Function, def: Object}} Returns an object with a definition\n  *          of the type and a create factory.\n  */\n  generate(type) {\n    const entry = this.types.get(type);\n    if (entry) {\n      return entry;\n    }\n    if (!this.schema.structs[type]) {\n      throw new Error(`${type} not found`);\n    }\n    const factory = this.generateApi(type, this.schema.structs[type]);\n    this.types.add(type, factory);\n    return factory;\n  }\n\n  /**\n  * Function used to generate an API definition for a given type.\n  * @private\n  * @param {String} type The type to generate.\n  * @param {Object} schema The schema describing the type.\n  * @returns {{create: (function(session:Object, handle:Number, id:String,\n  *          customKey:String)), def: Object}} Returns the API definition.\n  */\n  generateApi(type, schema) {\n    const api = Object.create({});\n\n    this.generateDefaultApi(api, schema); // Generate default\n    this.mixinType(type, api); // Mixin default type\n    this.mixinNamedParamFacade(api, schema); // Mixin named parameter support\n\n    return function create(session, handle, id, customKey) {\n      const instance = Object.create(api);\n\n      Events.mixin(instance); // Always mixin event-emitter per instance\n\n      Object.defineProperties(instance, {\n        session: {\n          enumerable: true,\n          value: session,\n        },\n        handle: {\n          enumerable: true,\n          value: handle,\n          writable: true,\n        },\n        id: {\n          enumerable: true,\n          value: id,\n        },\n        type: {\n          enumerable: true,\n          value: type,\n        },\n        genericType: {\n          enumerable: true,\n          value: customKey,\n        },\n      });\n\n      let mixinList = this.mixins.get(type) || [];\n      if (customKey !== type) {\n        this.mixinType(customKey, instance); // Mixin custom types\n        mixinList = mixinList.concat(this.mixins.get(customKey) || []);\n      }\n      mixinList.forEach((mixin) => {\n        if (typeof mixin.init === 'function') {\n          mixin.init({ config: this.config, api: instance });\n        }\n      });\n\n      return instance;\n    }.bind(this);\n  }\n\n  /**\n  * Function used to generate the methods with the right handlers to the object\n  * API that is being generated.\n  * @private\n  * @param {Object} api The object API that is currently being generated.\n  * @param {Object} schema The API definition.\n  */\n  generateDefaultApi(api, schema) {\n    Object.keys(schema).forEach((method) => {\n      const out = schema[method].Out;\n      const outKey = out.length === 1 ? out[0].Name : -1;\n      const fnName = toCamelCase(method);\n\n      api[fnName] = function generatedMethod(...params) {\n        return this.session.send({\n          handle: this.handle,\n          method,\n          params,\n          outKey,\n        });\n      };\n    });\n  }\n\n  /**\n  * Function used to add mixin methods to a specified API.\n  * @private\n  * @param {String} type Used to specify which mixin should be woven in.\n  * @param {Object} api The object that will be woven.\n  */\n  mixinType(type, api) {\n    const mixinList = this.mixins.get(type);\n    if (mixinList) {\n      mixinList.forEach(({ extend = {}, override = {} }) => {\n        Object.keys(override).forEach((key) => {\n          if (typeof api[key] === 'function' && typeof override[key] === 'function') {\n            const baseFn = api[key];\n            api[key] = function wrappedFn(...args) {\n              return override[key].apply(this, [baseFn.bind(this), ...args]);\n            };\n          } else {\n            throw new Error(`No function to override. Type: ${type} function: ${key}`);\n          }\n        });\n        Object.keys(extend).forEach((key) => {\n          // handle overrides\n          if (typeof api[key] === 'function' && typeof extend[key] === 'function') {\n            throw new Error(`Extend is not allowed for this mixin. Type: ${type} function: ${key}`);\n          } else {\n            api[key] = extend[key];\n          }\n        });\n      });\n    }\n  }\n\n  /**\n  * Function used to mixin the named parameter facade.\n  * @private\n  * @param {Object} api The object API that is currently being generated.\n  * @param {Object} schema The API definition.\n  */\n  mixinNamedParamFacade(api, schema) {\n    Object.keys(schema).forEach((key) => {\n      const fnName = toCamelCase(key);\n      const base = api[fnName];\n      const defaults = schema[key].In.reduce((result, item) => {\n        result[item.Name] = item.DefaultValue;\n        return result;\n      }, {});\n\n      api[fnName] = function namedParamWrapper(...params) {\n        return namedParamFacade.apply(this, [base, defaults, ...params]);\n      };\n    });\n  }\n}\n\nexport default Schema;\n","import Events from './event-emitter';\n\n/**\n * Helper class for handling RPC calls\n * @private\n */\nclass RPCResolver {\n  constructor(id, handle, resolve, reject) {\n    Events.mixin(this);\n    this.id = id;\n    this.handle = handle;\n    this.resolve = resolve;\n    this.reject = reject;\n  }\n\n  resolveWith(data) {\n    this.resolve(data);\n    this.emit('resolved', this.id);\n  }\n\n  rejectWith(err) {\n    this.reject(err);\n    this.emit('rejected', this.id);\n  }\n}\n\nexport default RPCResolver;\n","import Events from './event-emitter';\nimport RPCResolver from './rpc-resolver';\n\n/**\n* This class handles remote procedure calls on a web socket.\n* @private\n*/\nclass RPC {\n  /**\n  * Create a new RPC instance.\n  * @private\n  * @param {Object} options The configuration options for this class.\n  * @param {Function} options.Promise The promise constructor to use.\n  * @param {String} options.url The complete websocket URL used to connect.\n  * @param {Function} options.createSocket The function callback to create a WebSocket.\n  */\n  constructor(options) {\n    Object.assign(this, options);\n    Events.mixin(this);\n    this.resolvers = {};\n    this.requestId = 0;\n    this.openedPromise = undefined;\n  }\n\n  /**\n  * Opens a connection to the configured endpoint.\n  * @private\n  * @param {Boolean} force - ignores all previous and outstanding open calls if set to true.\n  * @returns {Object} A promise instance.\n  */\n  open(force = false) {\n    if (!force && this.openedPromise) {\n      return this.openedPromise;\n    }\n\n    try {\n      this.socket = this.createSocket(this.url);\n    } catch (err) {\n      return this.Promise.reject(err);\n    }\n\n    this.socket.onopen = this.onOpen.bind(this);\n    this.socket.onclose = this.onClose.bind(this);\n    this.socket.onerror = this.onError.bind(this);\n    this.socket.onmessage = this.onMessage.bind(this);\n    this.openedPromise = new this.Promise((resolve, reject) => this.registerResolver('opened', null, resolve, reject));\n    this.closedPromise = new this.Promise((resolve, reject) => this.registerResolver('closed', null, resolve, reject));\n    return this.openedPromise;\n  }\n\n  /**\n  * Resolves the open promise when a connection is successfully established.\n  * @private\n  */\n  onOpen() {\n    this.resolvers.opened.resolveWith(() => this.closedPromise);\n  }\n\n  /**\n  * Resolves the close promise when a connection is closed.\n  * @private\n  * @param {Object} event - The event describing close.\n  */\n  onClose(event) {\n    this.emit('closed', event);\n    this.resolvers.closed.resolveWith(event);\n    this.rejectAllOutstandingResolvers({ code: -1, message: 'Socket closed' });\n  }\n\n  /**\n  * Closes a connection.\n  * @private\n  * @param {Number} [code=1000] - The reason code for closing the connection.\n  * @param {String} [reason=\"\"] - The human readable string describing why the connection is closed.\n  * @returns {Object} Returns a promise instance.\n  */\n  close(code = 1000, reason = '') {\n    if (this.socket) {\n      this.socket.close(code, reason);\n      this.socket = null;\n    }\n    return this.closedPromise;\n  }\n\n  /**\n  * Emits an error event and rejects the open promise if an error is raised on the connection.\n  * @private\n  * @param {Object} event - The event describing the error.\n  */\n  onError(event) {\n    if (this.resolvers.opened) {\n      this.resolvers.opened.rejectWith(event);\n    } else {\n      // only emit errors after the initial open promise has been resolved,\n      // this makes it possible to catch early websocket errors as well\n      // as run-time ones:\n      this.emit('socket-error', event);\n    }\n    this.rejectAllOutstandingResolvers({ code: -1, message: 'Socket error' });\n  }\n\n  /**\n  * Parses the onMessage event on the connection and resolve the promise for the request.\n  * @private\n  * @param {Object} event - The event describing the message.\n  */\n  onMessage(event) {\n    const data = JSON.parse(event.data);\n    const resolver = this.resolvers[data.id] || {};\n    this.emit('traffic', 'received', data, resolver.handle);\n    if (typeof data.id !== 'undefined') {\n      this.emit('message', data);\n      this.resolvers[data.id].resolveWith(data);\n    } else {\n      this.emit(data.params ? 'notification' : 'message', data);\n    }\n  }\n\n  /**\n  * Rejects all outstanding resolvers.\n  * @private\n  * @param {Object} reason - The reject reason.\n  */\n  rejectAllOutstandingResolvers(reason) {\n    Object.keys(this.resolvers).forEach((id) => {\n      if (id === 'opened' || id === 'closed') {\n        return; // \"opened\" and \"closed\" should not be handled here\n      }\n      const resolver = this.resolvers[id];\n      resolver.rejectWith(reason);\n    });\n  }\n\n  /**\n  * Unregisters a resolver.\n  * @private\n  * @param {Number|String} id - The ID to unregister the resolver with.\n  */\n  unregisterResolver(id) {\n    const resolver = this.resolvers[id];\n    resolver.removeAllListeners();\n    delete this.resolvers[id];\n  }\n\n  /**\n  * Registers a resolver.\n  * @private\n  * @param {Number|String} id - The ID to register the resolver with.\n  * @param {Number} handle - The associated handle.\n  * @returns {Function} The promise executor function.\n  */\n  registerResolver(id, handle, resolve, reject) {\n    const resolver = new RPCResolver(id, handle, resolve, reject);\n    this.resolvers[id] = resolver;\n    resolver.on('resolved', resolvedId => this.unregisterResolver(resolvedId));\n    resolver.on('rejected', rejectedId => this.unregisterResolver(rejectedId));\n  }\n\n  /**\n  * Sends data on the socket.\n  * @private\n  * @param {Object} data - The data to send.\n  * @returns {Object} A promise instance.\n  */\n  send(data) {\n    if (!this.socket || this.socket.readyState !== this.socket.OPEN) {\n      const error = new Error('Not connected');\n      error.code = -1;\n      return this.Promise.reject(error);\n    }\n    if (!data.id) {\n      data.id = this.createRequestId();\n    }\n    data.jsonrpc = '2.0';\n    return new this.Promise((resolve, reject) => {\n      this.socket.send(JSON.stringify(data));\n      this.emit('traffic', 'sent', data, data.handle);\n      return this.registerResolver(data.id, data.handle, resolve, reject);\n    });\n  }\n\n  createRequestId() {\n    this.requestId += 1;\n    return this.requestId;\n  }\n}\n\nexport default RPC;\n","const ON_ATTACHED_TIMEOUT_MS = 5000;\nconst RPC_CLOSE_MANUAL_SUSPEND = 4000;\n\nclass SuspendResume {\n  /**\n  * Creates a new SuspendResume instance.\n  * @private\n  * @param {Object} options The configuration option for this class.\n  * @param {Promise<Object>} options.Promise The promise constructor to use.\n  * @param {RPC} options.rpc The RPC instance to use when communicating towards Engine.\n  * @param {ApiCache} options.apis The ApiCache instance to use.\n  */\n  constructor(options) {\n    Object.assign(this, options);\n    this.isSuspended = false;\n    this.rpc.on('traffic', (dir, data) => {\n      if (dir === 'sent' && data.method === 'OpenDoc') {\n        this.openDocParams = data.params;\n      }\n    });\n  }\n\n  /**\n  * Function used to restore the rpc connection.\n  * @private\n  * @param {Boolean} onlyIfAttached - if true, the returned promise will resolve\n  *                                   only if the session can be re-attached.\n  * @returns {Object} Returns a promise instance.\n  */\n  restoreRpcConnection(onlyIfAttached) {\n    return this.reopen(ON_ATTACHED_TIMEOUT_MS).then((sessionState) => {\n      if (sessionState === 'SESSION_CREATED' && onlyIfAttached) {\n        return this.Promise.reject(new Error('Not attached'));\n      }\n      return this.Promise.resolve();\n    });\n  }\n\n  /**\n  * Function used to restore the global API.\n  * @private\n  * @param {Object} changed - A list where the restored APIs will be added.\n  * @returns {Object} Returns a promise instance.\n  */\n  restoreGlobal(changed) {\n    const global = this.apis.getApisByType('Global').pop();\n    changed.push(global.api);\n    return this.Promise.resolve();\n  }\n\n  /**\n  * Function used to restore the doc API.\n  * @private\n  * @param {String} sessionState - The state of the session, attached or created.\n  * @param {Array} closed - A list where the closed of APIs APIs will be added.\n  * @param {Object} changed - A list where the restored APIs will be added.\n  * @returns {Object} Returns a promise instance.\n  */\n  restoreDoc(closed, changed) {\n    const doc = this.apis.getApisByType('Doc').pop();\n\n    if (!doc) {\n      return this.Promise.resolve();\n    }\n\n    return this.rpc.send({\n      method: 'GetActiveDoc',\n      handle: -1,\n      params: [],\n    }).then((response) => {\n      if (response.error && this.openDocParams) {\n        return this.rpc.send({\n          method: 'OpenDoc',\n          handle: -1,\n          params: this.openDocParams,\n        });\n      }\n      return response;\n    }).then((response) => {\n      if (response.error) {\n        closed.push(doc.api);\n        return this.Promise.resolve();\n      }\n      const handle = response.result.qReturn.qHandle;\n      doc.api.handle = handle;\n      changed.push(doc.api);\n      return this.Promise.resolve(doc.api);\n    });\n  }\n\n  /**\n  * Function used to restore the APIs on the doc.\n  * @private\n  * @param {Object} doc - The doc API on which the APIs we want to restore exist.\n  * @param {Array} closed - A list where the closed of APIs APIs will be added.\n  * @param {Object} changed - A list where the restored APIs will be added.\n  * @returns {Object} Returns a promise instance.\n  */\n  restoreDocObjects(doc, closed, changed) {\n    const tasks = [];\n    const apis = this.apis.getApis()\n      .map(entry => entry.api)\n      .filter(api => api.type !== 'Global' && api.type !== 'Doc');\n\n    if (!doc) {\n      apis.forEach(api => closed.push(api));\n      return this.Promise.resolve();\n    }\n\n    apis.forEach((api) => {\n      const method = SuspendResume.buildGetMethodName(api.type);\n\n      if (!method) {\n        closed.push(api);\n      } else {\n        const request = this.rpc.send({\n          method,\n          handle: doc.handle,\n          params: [api.id],\n        }).then((response) => {\n          if (response.error || !response.result.qReturn.qHandle) {\n            closed.push(api);\n          } else {\n            api.handle = response.result.qReturn.qHandle;\n            changed.push(api);\n          }\n        });\n        tasks.push(request);\n      }\n    });\n    return this.Promise.all(tasks);\n  }\n\n  /**\n  * Set the instance as suspended.\n  * @private\n  */\n  suspend() {\n    this.isSuspended = true;\n    return this.rpc.close(RPC_CLOSE_MANUAL_SUSPEND);\n  }\n\n  /**\n  * Resumes a previously suspended RPC connection, and refreshes the API cache.\n  *                                APIs unabled to be restored has their 'closed'\n  *                                event triggered, otherwise 'changed'.\n  * @private\n  * @emits API#changed\n  * @emits APIfunction@#closed\n  * @param {Boolean} onlyIfAttached if true, resume only if the session was re-attached.\n  * @returns {Promise<Object>} Eventually resolved if the RPC connection was successfully resumed,\n  *                    otherwise rejected.\n  */\n  resume(onlyIfAttached) {\n    const changed = [];\n    const closed = [];\n\n    return this.restoreRpcConnection(onlyIfAttached)\n      .then(() => this.restoreGlobal(changed))\n      .then(() => this.restoreDoc(closed, changed))\n      .then(doc => this.restoreDocObjects(doc, closed, changed))\n      .then(() => {\n        this.isSuspended = false;\n        this.apis.clear();\n        closed.forEach((api) => {\n          api.emit('closed');\n          api.removeAllListeners();\n        });\n        changed.forEach((api) => {\n          this.apis.add(api.handle, api);\n          if (api.type !== 'Global') {\n            api.emit('changed');\n          }\n        });\n      })\n      .catch(err => this.rpc.close().then(() => this.Promise.reject(err)));\n  }\n\n  /**\n  * Reopens the connection and waits for the OnConnected notification.\n  * @private\n  * @param {Number} timeout - The time to wait for the OnConnected notification.\n  * @returns {Object} A promise containing the session state (SESSION_CREATED or SESSION_ATTACHED).\n  */\n  reopen(timeout) {\n    let timer;\n    let notificationResolve;\n    let notificationReceived = false;\n    const notificationPromise = new this.Promise((resolve) => { notificationResolve = resolve; });\n\n    const waitForNotification = () => {\n      if (!notificationReceived) {\n        timer = setTimeout(() => notificationResolve('SESSION_CREATED'), timeout);\n      }\n      return notificationPromise;\n    };\n\n    const onNotification = (data) => {\n      if (data.method !== 'OnConnected') return;\n      clearTimeout(timer);\n      notificationResolve(data.params.qSessionState);\n      notificationReceived = true;\n    };\n\n    this.rpc.on('notification', onNotification);\n\n    return this.rpc.open(true)\n      .then(waitForNotification)\n      .then((state) => {\n        this.rpc.removeListener('notification', onNotification);\n        return state;\n      })\n      .catch((err) => {\n        this.rpc.removeListener('notification', onNotification);\n        return this.Promise.reject(err);\n      });\n  }\n\n  /**\n  * Function used to build the get method names for Doc APIs.\n  * @private\n  * @param {String} type - The API type.\n  * @returns {String} Returns the get method name, or undefined if the type cannot be restored.\n  */\n  static buildGetMethodName(type) {\n    if (type === 'Field' || type === 'Variable') {\n      return null;\n    }\n    if (type === 'GenericVariable') {\n      return 'GetVariableById';\n    }\n    return type.replace('Generic', 'Get');\n  }\n}\n\nexport default SuspendResume;\n","const SUCCESS_KEY = 'qSuccess';\n\nexport default function deltaRequestInterceptor(session, request) {\n  const delta = session.config.protocol.delta\n    && request.outKey !== -1\n    && request.outKey !== SUCCESS_KEY;\n  if (delta) {\n    request.delta = delta;\n  }\n  return request;\n}\n","/**\n* Response interceptor for generating APIs. Handles the quirks of engine not\n* returning an error when an object is missing.\n* @private\n* @param {Session} session - The session the intercept is being executed on.\n* @param {Object} request - The JSON-RPC request.\n* @param {Object} response - The response.\n* @returns {Object} - Returns the generated API\n*/\nexport default function apiInterceptor(session, request, response) {\n  if (response.qHandle && response.qType) {\n    return session.getObjectApi({\n      handle: response.qHandle,\n      type: response.qType,\n      id: response.qGenericId,\n      genericType: response.qGenericType,\n    });\n  }\n  if (response.qHandle === null && response.qType === null) {\n    return session.config.Promise.reject(new Error('Object not found'));\n  }\n  return response;\n}\n","'use strict';\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\nvar defineProperty = Object.defineProperty;\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nvar isArray = function isArray(arr) {\n\tif (typeof Array.isArray === 'function') {\n\t\treturn Array.isArray(arr);\n\t}\n\n\treturn toStr.call(arr) === '[object Array]';\n};\n\nvar isPlainObject = function isPlainObject(obj) {\n\tif (!obj || toStr.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar hasOwnConstructor = hasOwn.call(obj, 'constructor');\n\tvar hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) { /**/ }\n\n\treturn typeof key === 'undefined' || hasOwn.call(obj, key);\n};\n\n// If name is '__proto__', and Object.defineProperty is available, define __proto__ as an own property on target\nvar setProperty = function setProperty(target, options) {\n\tif (defineProperty && options.name === '__proto__') {\n\t\tdefineProperty(target, options.name, {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: true,\n\t\t\tvalue: options.newValue,\n\t\t\twritable: true\n\t\t});\n\t} else {\n\t\ttarget[options.name] = options.newValue;\n\t}\n};\n\n// Return undefined instead of __proto__ if '__proto__' is not an own property\nvar getProperty = function getProperty(obj, name) {\n\tif (name === '__proto__') {\n\t\tif (!hasOwn.call(obj, name)) {\n\t\t\treturn void 0;\n\t\t} else if (gOPD) {\n\t\t\t// In early versions of node, obj['__proto__'] is buggy when obj has\n\t\t\t// __proto__ as an own property. Object.getOwnPropertyDescriptor() works.\n\t\t\treturn gOPD(obj, name).value;\n\t\t}\n\t}\n\n\treturn obj[name];\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone;\n\tvar target = arguments[0];\n\tvar i = 1;\n\tvar length = arguments.length;\n\tvar deep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t}\n\tif (target == null || (typeof target !== 'object' && typeof target !== 'function')) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = getProperty(target, name);\n\t\t\t\tcopy = getProperty(options, name);\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target !== copy) {\n\t\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && isArray(src) ? src : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\t\tsetProperty(target, { name: name, newValue: extend(deep, clone, copy) });\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t\t} else if (typeof copy !== 'undefined') {\n\t\t\t\t\t\tsetProperty(target, { name: name, newValue: copy });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n","import originalExtend from 'extend';\n\nconst extend = originalExtend.bind(null, true);\nconst JSONPatch = {};\nconst { isArray } = Array;\nfunction isObject(v) { return v != null && !Array.isArray(v) && typeof v === 'object'; }\nfunction isUndef(v) { return typeof v === 'undefined'; }\nfunction isFunction(v) { return typeof v === 'function'; }\n\n/**\n* Generate an exact duplicate (with no references) of a specific value.\n*\n* @private\n* @param {Object} The value to duplicate\n* @returns {Object} a unique, duplicated value\n*/\nfunction generateValue(val) {\n  if (val) {\n    return extend({}, { val }).val;\n  }\n  return val;\n}\n\n/**\n* An additional type checker used to determine if the property is of internal\n* use or not a type that can be translated into JSON (like functions).\n*\n* @private\n* @param {Object} obj The object which has the property to check\n* @param {String} The property name to check\n* @returns {Boolean} Whether the property is deemed special or not\n*/\nfunction isSpecialProperty(obj, key) {\n  return isFunction(obj[key])\n    || key.substring(0, 2) === '$$'\n    || key.substring(0, 1) === '_';\n}\n\n/**\n* Finds the parent object from a JSON-Pointer (\"/foo/bar/baz\" = \"bar\" is \"baz\" parent),\n* also creates the object structure needed.\n*\n* @private\n* @param {Object} data The root object to traverse through\n* @param {String} The JSON-Pointer string to use when traversing\n* @returns {Object} The parent object\n*/\nfunction getParent(data, str) {\n  const seperator = '/';\n  const parts = str.substring(1).split(seperator).slice(0, -1);\n  let numPart;\n\n  parts.forEach((part, i) => {\n    if (i === parts.length) {\n      return;\n    }\n    numPart = +part;\n    const newPart = !isNaN(numPart) ? [] : {};\n    data[numPart || part] = isUndef(data[numPart || part])\n      ? newPart\n      : data[part];\n    data = data[numPart || part];\n  });\n\n  return data;\n}\n\n/**\n* Cleans an object of all its properties, unless they're deemed special or\n* cannot be removed by configuration.\n*\n* @private\n* @param {Object} obj The object to clean\n*/\nfunction emptyObject(obj) {\n  Object.keys(obj).forEach((key) => {\n    const config = Object.getOwnPropertyDescriptor(obj, key);\n\n    if (config.configurable && !isSpecialProperty(obj, key)) {\n      delete obj[key];\n    }\n  });\n}\n\n/**\n* Compare an object with another, could be object, array, number, string, bool.\n* @private\n* @param {Object} a The first object to compare\n* @param {Object} a The second object to compare\n* @returns {Boolean} Whether the objects are identical\n*/\nfunction compare(a, b) {\n  let isIdentical = true;\n\n  if (isObject(a) && isObject(b)) {\n    if (Object.keys(a).length !== Object.keys(b).length) {\n      return false;\n    }\n    Object.keys(a).forEach((key) => {\n      if (!compare(a[key], b[key])) {\n        isIdentical = false;\n      }\n    });\n    return isIdentical;\n  } if (isArray(a) && isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n    for (let i = 0, l = a.length; i < l; i += 1) {\n      if (!compare(a[i], b[i])) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return a === b;\n}\n\n/**\n* Generates patches by comparing two arrays.\n*\n* @private\n* @param {Array} oldA The old (original) array, which will be patched\n* @param {Array} newA The new array, which will be used to compare against\n* @returns {Array} An array of patches (if any)\n*/\nfunction patchArray(original, newA, basePath) {\n  let patches = [];\n  const oldA = original.slice();\n  let tmpIdx = -1;\n\n  function findIndex(a, id, idx) {\n    if (a[idx] && isUndef(a[idx].qInfo)) {\n      return null;\n    } if (a[idx] && a[idx].qInfo.qId === id) {\n      // shortcut if identical\n      return idx;\n    }\n    for (let ii = 0, ll = a.length; ii < ll; ii += 1) {\n      if (a[ii] && a[ii].qInfo.qId === id) {\n        return ii;\n      }\n    }\n    return -1;\n  }\n\n  if (compare(newA, oldA)) {\n    // array is unchanged\n    return patches;\n  }\n\n  if (!isUndef(newA[0]) && isUndef(newA[0].qInfo)) {\n    // we cannot create patches without unique identifiers, replace array...\n    patches.push({\n      op: 'replace',\n      path: basePath,\n      value: newA,\n    });\n    return patches;\n  }\n\n  for (let i = oldA.length - 1; i >= 0; i -= 1) {\n    tmpIdx = findIndex(newA, oldA[i].qInfo && oldA[i].qInfo.qId, i);\n    if (tmpIdx === -1) {\n      patches.push({\n        op: 'remove',\n        path: `${basePath}/${i}`,\n      });\n      oldA.splice(i, 1);\n    } else {\n      patches = patches.concat(JSONPatch.generate(oldA[i], newA[tmpIdx], `${basePath}/${i}`));\n    }\n  }\n\n  for (let i = 0, l = newA.length; i < l; i += 1) {\n    tmpIdx = findIndex(oldA, newA[i].qInfo && newA[i].qInfo.qId);\n    if (tmpIdx === -1) {\n      patches.push({\n        op: 'add',\n        path: `${basePath}/${i}`,\n        value: newA[i],\n      });\n      oldA.splice(i, 0, newA[i]);\n    } else if (tmpIdx !== i) {\n      patches.push({\n        op: 'move',\n        path: `${basePath}/${i}`,\n        from: `${basePath}/${tmpIdx}`,\n      });\n      oldA.splice(i, 0, oldA.splice(tmpIdx, 1)[0]);\n    }\n  }\n  return patches;\n}\n\n/**\n* Generate an array of JSON-Patch:es following the JSON-Patch Specification Draft.\n*\n* See [specification draft](http://tools.ietf.org/html/draft-ietf-appsawg-json-patch-10)\n*\n* Does NOT currently generate patches for arrays (will replace them)\n* @private\n* @param {Object} original The object to patch to\n* @param {Object} newData The object to patch from\n* @param {String} [basePath] The base path to use when generating the paths for\n*                            the patches (normally not used)\n* @returns {Array} An array of patches\n*/\nJSONPatch.generate = function generate(original, newData, basePath) {\n  basePath = basePath || '';\n  let patches = [];\n\n  Object.keys(newData).forEach((key) => {\n    const val = generateValue(newData[key]);\n    const oldVal = original[key];\n    const tmpPath = `${basePath}/${key}`;\n\n    if (compare(val, oldVal) || isSpecialProperty(newData, key)) {\n      return;\n    }\n    if (isUndef(oldVal)) {\n      // property does not previously exist\n      patches.push({\n        op: 'add',\n        path: tmpPath,\n        value: val,\n      });\n    } else if (isObject(val) && isObject(oldVal)) {\n      // we need to generate sub-patches for this, since it already exist\n      patches = patches.concat(JSONPatch.generate(oldVal, val, tmpPath));\n    } else if (isArray(val) && isArray(oldVal)) {\n      patches = patches.concat(patchArray(oldVal, val, tmpPath));\n    } else {\n      // it's a simple property (bool, string, number)\n      patches.push({\n        op: 'replace',\n        path: `${basePath}/${key}`,\n        value: val,\n      });\n    }\n  });\n\n  Object.keys(original).forEach((key) => {\n    if (isUndef(newData[key]) && !isSpecialProperty(original, key)) {\n      // this property does not exist anymore\n      patches.push({\n        op: 'remove',\n        path: `${basePath}/${key}`,\n      });\n    }\n  });\n\n  return patches;\n};\n\n/**\n* Apply a list of patches to an object.\n* @private\n* @param {Object} original The object to patch\n* @param {Array} patches The list of patches to apply\n*/\nJSONPatch.apply = function apply(original, patches) {\n  patches.forEach((patch) => {\n    let parent = getParent(original, patch.path);\n    let key = patch.path.split('/').splice(-1)[0];\n    let target = key && isNaN(+key) ? parent[key] : parent[+key] || parent;\n    const from = patch.from ? patch.from.split('/').splice(-1)[0] : null;\n\n    if (patch.path === '/') {\n      parent = null;\n      target = original;\n    }\n\n    if (patch.op === 'add' || patch.op === 'replace') {\n      if (isArray(parent)) {\n        // trust indexes from patches, so don't replace the index if it's an add\n        if (key === '-') {\n          key = parent.length;\n        }\n        parent.splice(+key, patch.op === 'add' ? 0 : 1, patch.value);\n      } else if (isArray(target) && isArray(patch.value)) {\n        const newValues = patch.value.slice();\n        // keep array reference if possible...\n        target.length = 0;\n        target.push(...newValues);\n      } else if (isObject(target) && isObject(patch.value)) {\n        // keep object reference if possible...\n        emptyObject(target);\n        extend(target, patch.value);\n      } else if (!parent) {\n        throw new Error('Patchee is not an object we can patch');\n      } else {\n        // simple value\n        parent[key] = patch.value;\n      }\n    } else if (patch.op === 'move') {\n      const oldParent = getParent(original, patch.from);\n      if (isArray(parent)) {\n        parent.splice(+key, 0, oldParent.splice(+from, 1)[0]);\n      } else {\n        parent[key] = oldParent[from];\n        delete oldParent[from];\n      }\n    } else if (patch.op === 'remove') {\n      if (isArray(parent)) {\n        parent.splice(+key, 1);\n      } else {\n        delete parent[key];\n      }\n    }\n  });\n};\n\n/**\n* Deep clone an object.\n* @private\n* @param {Object} obj The object to clone\n* @returns {Object} A new object identical to the `obj`\n*/\nJSONPatch.clone = function clone(obj) {\n  return extend({}, obj);\n};\n\n/**\n* Creates a JSON-patch.\n* @private\n* @param {String} op The operation of the patch. Available values: \"add\", \"remove\", \"move\"\n* @param {Object} [val] The value to set the `path` to. If `op` is `move`, `val`\n*                       is the \"from JSON-path\" path\n* @param {String} path The JSON-path for the property to change (e.g. \"/qHyperCubeDef/columnOrder\")\n* @returns {Object} A patch following the JSON-patch specification\n*/\nJSONPatch.createPatch = function createPatch(op, val, path) {\n  const patch = {\n    op: op.toLowerCase(),\n    path,\n  };\n  if (patch.op === 'move') {\n    patch.from = val;\n  } else if (typeof val !== 'undefined') {\n    patch.value = val;\n  }\n  return patch;\n};\n\n/**\n* Apply the differences of two objects (keeping references if possible).\n* Identical to running `JSONPatch.apply(original, JSONPatch.generate(original, newData));`\n* @private\n* @param {Object} original The object to update/patch\n* @param {Object} newData the object to diff against\n*\n* @example\n* var obj1 = { foo: [1,2,3], bar: { baz: true, qux: 1 } };\n* var obj2 = { foo: [4,5,6], bar: { baz: false } };\n* JSONPatch.updateObject(obj1, obj2);\n* // => { foo: [4,5,6], bar: { baz: false } };\n*/\nJSONPatch.updateObject = function updateObject(original, newData) {\n  if (!Object.keys(original).length) {\n    extend(original, newData);\n    return;\n  }\n  JSONPatch.apply(original, JSONPatch.generate(original, newData));\n};\n\nexport default JSONPatch;\n","import JSONPatch from '../../json-patch';\nimport KeyValueCache from '../../cache';\n\nconst sessions = {};\n\n/**\n* Function to make sure we release handle caches when they are closed.\n* @private\n* @param {Session} session The session instance to listen on.\n*/\nconst bindSession = (session) => {\n  if (!sessions[session.id]) {\n    const cache = {};\n    sessions[session.id] = cache;\n    session.on('traffic:received', data => data.close && data.close.forEach(handle => delete cache[handle]));\n    session.on('closed', () => delete sessions[session.id]);\n  }\n};\n\n/**\n* Simple function that ensures the session events has been bound, and returns\n* either an existing key-value cache or creates one for the specified handle.\n* @private\n* @param {Session} session The session that owns the handle.\n* @param {Number} handle The object handle to retrieve the cache for.\n* @returns {KeyValueCache} The cache instance.\n*/\nconst getHandleCache = (session, handle) => {\n  bindSession(session);\n  const cache = sessions[session.id];\n  if (!cache[handle]) {\n    cache[handle] = new KeyValueCache();\n  }\n  return cache[handle];\n};\n\n/**\n* Function used to apply a list of patches and return the patched value.\n* @private\n* @param {Session} session The session.\n* @param {Number} handle The object handle.\n* @param {String} cacheId The cacheId.\n* @param {Array} patches The patches.\n* @returns {Object} Returns the patched value.\n*/\nconst patchValue = (session, handle, cacheId, patches) => {\n  const cache = getHandleCache(session, handle);\n  let entry = cache.get(cacheId);\n  if (typeof entry === 'undefined') {\n    entry = Array.isArray(patches[0].value) ? [] : {};\n  }\n  if (patches.length) {\n    if (patches[0].path === '/' && typeof patches[0].value !== 'object') {\n      // 'plain' values on root path is not supported (no object reference),\n      // so we simply store the value directly:\n      entry = patches[0].value;\n    } else {\n      JSONPatch.apply(entry, patches);\n    }\n    cache.set(cacheId, entry);\n  }\n  return entry;\n};\n\n/**\n* Process delta interceptor.\n* @private\n* @param {Session} session The session the intercept is being executed on.\n* @param {Object} request The JSON-RPC request.\n* @param {Object} response The response.\n* @returns {Object} Returns the patched response\n*/\nexport default function deltaInterceptor(session, request, response) {\n  const { delta, result } = response;\n  if (delta) {\n    // when delta is on the response data is expected to be an array of patches:\n    Object.keys(result).forEach((key) => {\n      if (!Array.isArray(result[key])) {\n        throw new Error('Unexpected RPC response, expected array of patches');\n      }\n      result[key] = patchValue(session, request.handle, `${request.method}-${key}`, result[key]);\n    });\n    // return a cloned response object to avoid patched object references:\n    return JSON.parse(JSON.stringify(response));\n  }\n  return response;\n}\n\n// export object reference for testing purposes:\ndeltaInterceptor.sessions = sessions;\n","/**\n* Process error interceptor.\n* @private\n* @param {Session} session - The session the intercept is being executed on.\n* @param {Object} request - The JSON-RPC request.\n* @param {Object} response - The response.\n* @returns {Object} - Returns the defined error for an error, else the response.\n*/\nexport default function errorInterceptor(session, request, response) {\n  if (typeof response.error !== 'undefined') {\n    const data = response.error;\n    const error = new Error(data.message);\n    error.code = data.code;\n    error.parameter = data.parameter;\n    return session.config.Promise.reject(error);\n  }\n  return response;\n}\n","const RETURN_KEY = 'qReturn';\n\n/**\n* Picks out the result \"out\" parameter based on the QIX method+schema, with\n* some specific handling for some methods that breaks the predictable protocol.\n* @private\n* @param {Session} session - The session the intercept is being executed on.\n* @param {Object} request - The JSON-RPC request.\n* @param {Object} response - The response.\n* @returns {Object} - Returns the result property on the response\n*/\nexport default function outParamInterceptor(session, request, response) {\n  if (request.method === 'CreateSessionApp' || request.method === 'CreateSessionAppFromApp') {\n    // this method returns multiple out params that we need\n    // to normalize before processing the response further:\n    response[RETURN_KEY].qGenericId = response[RETURN_KEY].qGenericId || response.qSessionAppId;\n  } else if (request.method === 'GetInteract') {\n    // this method returns a qReturn value when it should only return\n    // meta.outKey:\n    delete response[RETURN_KEY];\n  }\n\n  if (hasOwnProperty.call(response, RETURN_KEY)) {\n    return response[RETURN_KEY];\n  }\n  if (request.outKey !== -1) {\n    return response[request.outKey];\n  }\n\n  return response;\n}\n","/**\n* Process result interceptor.\n* @private\n* @param {Session} session - The session the intercept is being executed on.\n* @param {Object} request - The JSON-RPC request.\n* @param {Object} response - The response.\n* @returns {Object} - Returns the result property on the response\n*/\nexport default function resultInterceptor(session, request, response) {\n  return response.result;\n}\n","import deltaRequest from './interceptors/request/delta';\nimport apiResponse from './interceptors/response/api';\nimport deltaResponse from './interceptors/response/delta';\nimport errorResponse from './interceptors/response/error';\nimport outParamResponse from './interceptors/response/out-param';\nimport resultResponse from './interceptors/response/result';\n\n/**\n * Interceptors is a concept similar to mixins, but run on a lower level. The interceptor concept\n * can augment either the requests (i.e. before sent to QIX Engine), or the responses (i.e. after\n * QIX Engine has sent a response). The interceptor promises runs in parallel to the regular\n * promises used in enigma.js, which means that it can be really useful when you want to normalize\n * behaviors in your application.\n * @interface Interceptor\n */\n\n/**\n  * @class InterceptorRequest\n  * @implements {Interceptor}\n  */\n\n/**\n * @class InterceptorResponse\n * @implements {Interceptor}\n */\n\n/**\n * This method is invoked when a request is about to be sent to QIX Engine.\n * @function InterceptorRequest#onFulfilled\n * @param {Session} session The session executing the interceptor.\n * @param {Object} request The JSON-RPC request that will be sent.\n */\n\n/**\n * This method is invoked when a previous interceptor has rejected the\n * promise, use this to handle for example errors before they are sent into mixins.\n * @function InterceptorResponse#onRejected\n * @param {Session} session The session executing the interceptor. You may use .retry() to retry\n * sending it to QIX Engine.\n * @param {Object} request The JSON-RPC request resulting in this error.\n * @param {Object} error Whatever the previous interceptor is rejected with.\n */\n\n/**\n * This method is invoked when a promise has been successfully resolved,\n * use this to modify the result or reject the promise chain before it is sent\n * to mixins.\n * @function InterceptorResponse#onFulfilled\n * @param {Session} session The session executing the interceptor.\n * @param {Object} request The JSON-RPC request resulting in this response.\n * @param {Object} result Whatever the previous interceptor is resolved with.\n */\nclass Intercept {\n  /**\n  * Create a new Intercept instance.\n  * @private\n  * @param {Object} options The configuration options for this class.\n  * @param {Promise<Object>} options.Promise The promise constructor to use.\n  * @param {ApiCache} options.apis The ApiCache instance to use.\n  * @param {Array<Object>} [options.request] The additional request interceptors to use.\n  * @param {Array<Object>} [options.response] The additional response interceptors to use.\n  */\n  constructor(options) {\n    Object.assign(this, options);\n    this.request = [{ onFulfilled: deltaRequest }, ...this.request || []];\n    this.response = [\n      { onFulfilled: errorResponse },\n      { onFulfilled: deltaResponse },\n      { onFulfilled: resultResponse },\n      { onFulfilled: outParamResponse },\n      ...this.response || [],\n      { onFulfilled: apiResponse },\n    ];\n  }\n\n  /**\n  * Execute the request interceptor queue, each interceptor will get the result from\n  * the previous interceptor.\n  * @private\n  * @param {Session} session The session instance to execute against.\n  * @param {Promise<Object>} promise The promise to chain on to.\n  * @returns {Promise<Object>}\n  */\n  executeRequests(session, promise) {\n    return this.request.reduce((interception, interceptor) => {\n      const intercept = interceptor.onFulfilled\n      && interceptor.onFulfilled.bind(this, session);\n      return interception.then(intercept);\n    }, promise);\n  }\n\n  /**\n  * Execute the response interceptor queue, each interceptor will get the result from\n  * the previous interceptor.\n  * @private\n  * @param {Session} session The session instance to execute against.\n  * @param {Promise<Object>} promise The promise to chain on to.\n  * @param {Object} request The JSONRPC request object for the intercepted response.\n  * @returns {Promise<Object>}\n  */\n  executeResponses(session, promise, request) {\n    return this.response.reduce((interception, interceptor) => interception.then(\n      interceptor.onFulfilled && interceptor.onFulfilled.bind(this, session, request),\n      interceptor.onRejected && interceptor.onRejected.bind(this, session, request),\n    ),\n    promise);\n  }\n}\n\nexport default Intercept;\n","import KeyValueCache from './cache';\n\n/**\n* API cache for instances of QIX types, e.g. GenericObject.\n* @private\n* @extends KeyValueCache\n*/\nclass ApiCache extends KeyValueCache {\n  /**\n  * Adds an API.\n  * @private\n  * @function ApiCache#add\n  * @param {Number} handle - The handle for the API.\n  * @param {*} api - The API.\n  * @returns {{api: *}} The entry.\n  */\n  add(handle, api) {\n    const entry = { api };\n    super.add(handle.toString(), entry);\n    api.on('closed', () => this.remove(handle));\n    return entry;\n  }\n\n  /**\n  * Gets an API.\n  * @private\n  * @function ApiCache#getApi\n  * @param {Number} handle - The handle for the API.\n  * @returns {*} The API for the handle.\n  */\n  getApi(handle) {\n    const entry = typeof handle !== 'undefined' ? this.get(handle.toString()) : undefined;\n    return entry && entry.api;\n  }\n\n  /**\n  * Gets a list of APIs.\n  * @private\n  * @function ApiCache#getApis\n  * @returns {Array} The list of entries including `handle` and `api` properties for each entry.\n  */\n  getApis() {\n    return super.getAll().map(entry => ({\n      handle: entry.key,\n      api: entry.value.api,\n    }));\n  }\n\n  /**\n  * Gets a list of APIs with a given type.\n  * @private\n  * @function ApiCache#getApisByType\n  * @param {String} type - The type of APIs to get.\n  * @returns {Array} The list of entries including `handle` and `api` properties for each entry.\n  */\n  getApisByType(type) {\n    return this.getApis().filter(entry => entry.api.type === type);\n  }\n}\n\nexport default ApiCache;\n","import Session from './session';\nimport Schema from './schema';\nimport RPC from './rpc';\nimport SuspendResume from './suspend-resume';\nimport Intercept from './intercept';\nimport ApiCache from './api-cache';\n\n/**\n * The enigma.js configuration object.\n * @interface Configuration\n * @property {Object} schema Object containing the specification for the API to generate.\n * Corresponds to a specific version of the QIX Engine API.\n * @property {String} url String containing a proper websocker URL to QIX Engine.\n * @property {Function} [createSocket] A function to use when instantiating the WebSocket,\n * mandatory for Node.js.\n * @property {Object} [Promise] ES6-compatible Promise library.\n * @property {Boolean} [suspendOnClose=false] Set to true if the session should be suspended\n * instead of closed when the websocket is closed.\n * @property {Array<Mixin>} [mixins=[]] Mixins to extend/augment the QIX Engine API. Mixins\n * are applied in the array order.\n * @property {Array} [requestInterceptors=[]] Interceptors for augmenting requests before they\n * are sent to QIX Engine. Interceptors are applied in the array order.\n * @property {Array} [responseInterceptors=[]] Interceptors for augmenting responses before they\n * are passed into mixins and end-users. Interceptors are applied in the array order.\n * @property {Object} [protocol={}] An object containing additional JSON-RPC request parameters.\n * @property {Boolean} [protocol.delta=true] Set to false to disable the use of the\n * bandwidth-reducing delta protocol.\n */\n\n/**\n * Mixin object to extend/augment the QIX Engine API\n * @interface Mixin\n * @property {String|Array<String>} types String or array of strings containing the API-types that\n * will be mixed in.\n * @property {Object} [extend] Object literal containing the methods that will be extended on the\n * specified API.\n * @property {Object} [override] Object literal containing the methods to override existing methods.\n * @property {Function} [init] Init function that, if defined, will run when an API is instantiated.\n * It runs with Promise and API object as parameters\n */\n\n/**\n * The API for generated APIs depends on the QIX Engine schema you pass into your Configuration,\n * and on what QIX struct the API has.\n * @interface API\n * @property {String} id Contains the unique identifier for this API.\n * @property {String} type Contains the schema class name for this API.\n * @property {String} genericType Corresponds to the qInfo.qType property on the generic object's\n * properties object.\n * @property {Session} session Contains a reference to the session that this API belongs to.\n * @property {Number} handle Contains the handle QIX Engine assigned to the API. Used interally in\n * enigma.js for caches and JSON-RPC requests.\n */\n\n/**\n * Handle changes on the API. The changed event is triggered whenever enigma.js or QIX Engine has\n * identified potential changes on the underlying properties or hypercubes and you should re-fetch\n * your data.\n * @event API#changed\n * @type {Object}\n */\n\n/**\n * Handle closed API. The closed event is triggered whenever QIX Engine considers an API closed.\n * It usually means that it no longer exist in the QIX Engine document or session.\n * @event API#closed\n * @type {Object}\n */\n\n/**\n * Handle JSON-RPC requests/responses for this API. Generally used in debugging purposes.\n * traffic:* will handle all websocket messages, traffic:sent will handle outgoing messages\n * and traffic:received will handle incoming messages.\n * @event API#traffic\n * @type {Object}\n */\n\n/**\n* Qix service.\n*/\nclass Qix {\n  /**\n  * Function used to get a session.\n  * @private\n  * @param {Configuration} config The configuration object for this session.\n  * @returns {Session} Returns a session instance.\n  */\n  static getSession(config) {\n    const {\n      createSocket,\n      Promise,\n      requestInterceptors,\n      responseInterceptors,\n      url,\n    } = config;\n    const apis = new ApiCache();\n    const intercept = new Intercept({\n      apis,\n      Promise,\n      request: requestInterceptors,\n      response: responseInterceptors,\n    });\n    const rpc = new RPC({ createSocket, Promise, url });\n    const suspendResume = new SuspendResume({ apis, Promise, rpc });\n    const session = new Session({\n      apis,\n      config,\n      intercept,\n      rpc,\n      suspendResume,\n    });\n    return session;\n  }\n\n  /**\n  * Function used to create a QIX session.\n  * @param {Configuration} config The configuration object for the QIX session.\n  * @returns {Session} Returns a new QIX session.\n  */\n  static create(config) {\n    Qix.configureDefaults(config);\n    config.mixins.forEach((mixin) => {\n      config.definition.registerMixin(mixin);\n    });\n    return Qix.getSession(config);\n  }\n\n  /**\n  * Function used to configure defaults.\n  * @private\n  * @param {Configuration} config The configuration object for how to connect\n  *                               and retrieve end QIX APIs.\n  */\n  static configureDefaults(config) {\n    if (!config) {\n      throw new Error('You need to supply a configuration.');\n    }\n\n    // eslint-disable-next-line no-restricted-globals\n    if (!config.Promise && typeof Promise === 'undefined') {\n      throw new Error('Your environment has no Promise implementation. You must provide a Promise implementation in the config.');\n    }\n\n    if (typeof config.createSocket !== 'function' && typeof WebSocket === 'function') {\n      // eslint-disable-next-line no-undef\n      config.createSocket = url => new WebSocket(url);\n    }\n\n    if (typeof config.suspendOnClose === 'undefined') {\n      config.suspendOnClose = false;\n    }\n\n    config.protocol = config.protocol || {};\n    config.protocol.delta = typeof config.protocol.delta !== 'undefined' ? config.protocol.delta : true;\n    // eslint-disable-next-line no-restricted-globals\n    config.Promise = config.Promise || Promise;\n    config.mixins = config.mixins || [];\n    config.definition = config.definition || new Schema(config);\n  }\n}\n\nexport default Qix;\n"],"names":["mixin","obj","Object","keys","EventEmitter","prototype","forEach","key","init","RPC_CLOSE_NORMAL","RPC_CLOSE_MANUAL_SUSPEND","cacheId","Session","options","session","assign","Promise","config","definition","id","rpc","on","onRpcError","bind","onRpcClosed","onRpcMessage","onRpcNotification","onRpcTraffic","onSessionClosed","err","suspendResume","isSuspended","emit","evt","code","suspendOnClose","suspend","then","initiator","response","change","handle","emitHandleChanged","close","emitHandleClosed","method","params","dir","data","api","apis","getApi","getApis","entry","removeAllListeners","clear","args","type","genericType","factory","generate","add","globalPromise","open","getObjectApi","global","request","reject","Error","createRequestId","promise","intercept","executeRequests","resolve","augmentedRequest","protocol","outKey","send","retry","executeResponses","addToPromiseChain","onlyIfAttached","resume","value","undefined","name","patchedThen","chain","apply","KeyValueCache","entries","map","filter","hasOwnProperty","toCamelCase","symbol","substring","toLowerCase","namedParamFacade","base","defaults","length","Array","isArray","valid","every","call","Schema","schema","mixins","types","extend","override","push","cached","typeKey","entryList","get","structs","generateApi","create","generateDefaultApi","mixinType","mixinNamedParamFacade","customKey","instance","Events","defineProperties","enumerable","writable","mixinList","concat","out","Out","Name","fnName","generatedMethod","baseFn","wrappedFn","In","reduce","result","item","DefaultValue","namedParamWrapper","RPCResolver","RPC","resolvers","requestId","openedPromise","force","socket","createSocket","url","onopen","onOpen","onclose","onClose","onerror","onError","onmessage","onMessage","registerResolver","closedPromise","opened","resolveWith","event","closed","rejectAllOutstandingResolvers","message","reason","rejectWith","JSON","parse","resolver","resolvedId","unregisterResolver","rejectedId","readyState","OPEN","error","jsonrpc","stringify","ON_ATTACHED_TIMEOUT_MS","SuspendResume","openDocParams","reopen","sessionState","changed","getApisByType","pop","doc","qReturn","qHandle","tasks","buildGetMethodName","all","restoreRpcConnection","restoreGlobal","restoreDoc","restoreDocObjects","catch","timeout","timer","notificationResolve","notificationReceived","notificationPromise","waitForNotification","setTimeout","onNotification","clearTimeout","qSessionState","state","removeListener","replace","SUCCESS_KEY","deltaRequestInterceptor","delta","apiInterceptor","qType","qGenericId","qGenericType","originalExtend","JSONPatch","isObject","v","isUndef","isFunction","generateValue","val","isSpecialProperty","getParent","str","seperator","parts","split","slice","numPart","part","i","newPart","isNaN","emptyObject","getOwnPropertyDescriptor","configurable","compare","a","b","isIdentical","l","patchArray","original","newA","basePath","patches","oldA","tmpIdx","findIndex","idx","qInfo","qId","ii","ll","op","path","splice","from","newData","oldVal","tmpPath","patch","parent","target","newValues","oldParent","clone","createPatch","updateObject","sessions","bindSession","cache","getHandleCache","patchValue","set","deltaInterceptor","errorInterceptor","parameter","RETURN_KEY","outParamInterceptor","qSessionAppId","resultInterceptor","Intercept","onFulfilled","deltaRequest","errorResponse","deltaResponse","resultResponse","outParamResponse","apiResponse","interception","interceptor","onRejected","ApiCache","toString","remove","Qix","requestInterceptors","responseInterceptors","configureDefaults","registerMixin","getSession","WebSocket"],"mappings":"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"}